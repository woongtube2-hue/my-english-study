<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>English Study - Focus Mode</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background: #f8f9fa; }
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .controls { margin-bottom: 20px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        
        /* ì•”ê¸° ëª¨ë“œ ìŠ¤íƒ€ì¼ */
        .blur { filter: blur(5px); transition: filter 0.3s; }
        .blur:hover { filter: blur(0); } /* ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ì‚´ì§ ë³´ì„ */
        
        button { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; transition: 0.2s; font-weight: bold; }
        .btn-tts { background: #007bff; color: white; }
        .btn-hide { background: #6c757d; color: white; }
        button:hover { opacity: 0.8; }
        
        #content { white-space: pre-wrap; font-size: 1.1rem; }
        .highlight-script { color: #e67e22; font-weight: bold; border-left: 4px solid #e67e22; padding-left: 10px; display: block; margin: 10px 0; }
    </style>
</head>
<body>

    <h1>ğŸ™ï¸ English Practice Room</h1>
    
    <div class="controls">
        <select id="day-select" onchange="loadScript(this.value)" style="padding: 8px;">
            <option value="1">Day 1: Parks</option>
        </select>
        <button class="btn-tts" onclick="speakText()">ğŸ”Š ì „ì²´ ì½ê¸°</button>
        <button class="btn-hide" onclick="toggleHide()">ğŸ™ˆ ì•”ê¸° ëª¨ë“œ ON/OFF</button>
    </div>

    <div class="card">
        <div id="content">ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>

    <script>
        let currentRawText = "";

        // 1. íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadScript(day) {
            const contentDiv = document.getElementById('content');
            try {
                const response = await fetch(`./script/day${day}.txt`);
                currentRawText = await response.text();
                
                // ê°€ë…ì„±ì„ ìœ„í•´ Script: ë¶€ë¶„ë§Œ ë””ìì¸ ì ìš©
                const formattedText = currentRawText.replace(/Script:(.*)/g, '<span class="highlight-script">Script:$1</span>');
                contentDiv.innerHTML = formattedText;
            } catch (error) {
                contentDiv.innerText = "íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            }
        }

        // 2. ìŒì„± í•©ì„± (TTS) ê¸°ëŠ¥
        function speakText() {
            // Script: ì´í›„ì˜ ë¬¸ì¥ë“¤ë§Œ ì¶”ì¶œí•´ì„œ ì½ê¸°
            const scriptMatches = currentRawText.match(/Script:(.*)/g);
            if (!scriptMatches) return;

            const textToSpeak = scriptMatches.map(s => s.replace('Script:', '')).join('. ');
            
            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = 'en-US'; // ì˜ì–´ ë°œìŒ ì„¤ì •
            utterance.rate = 0.9;     // ì†ë„ ì¡°ì ˆ (ì•½ê°„ ì²œì²œíˆ)
            window.speechSynthesis.speak(utterance);
        }

        // 3. ì•”ê¸° ëª¨ë“œ (Toggle) ê¸°ëŠ¥
        function toggleHide() {
            const scripts = document.querySelectorAll('.highlight-script');
            scripts.forEach(s => s.classList.toggle('blur'));
        }

        window.onload = () => loadScript(1);
    </script>
</body>
</html>