<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>English Study - Individual Play</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background: #f4f7f6; }
        .day-header { text-align: center; margin-bottom: 30px; }
        .day-header h1 { color: #2c3e50; font-size: 2rem; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; border-left: 6px solid #3498db; }
        .q-title { color: #e67e22; font-weight: bold; font-size: 1.2rem; margin-bottom: 5px; }
        .q-question { color: #34495e; font-style: italic; margin-bottom: 15px; background: #f9f9f9; padding: 10px; border-radius: 5px; }
        .s-box { background: #fff; border: 1px solid #eee; padding: 15px; border-radius: 8px; white-space: pre-wrap; margin-top: 10px; }
        .btn-play { background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-play:hover { background: #2980b9; }
        .blur { filter: blur(5px); transition: 0.3s; }
        .blur:hover { filter: blur(0); }
        .controls { margin-bottom: 20px; display: flex; gap: 10px; justify-content: center; }
    </style>
</head>
<body>

    <div class="day-header">
        <h1 id="main-title">í•™ìŠµ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</h1>
        <div class="controls">
            <select id="day-select" onchange="loadScript(this.value)">
            <option value="1">Day 1: ê³µì›(Parks)</option>
            <option value="2">Day 2: í•´ë³€(seas)</option>
        </select>
            <button onclick="toggleBlur()" style="padding: 8px 15px; border-radius: 5px; cursor: pointer;">ğŸ™ˆ ì•”ê¸°ëª¨ë“œ ON/OFF</button>
        </div>
    </div>

    <div id="container"></div>

    <script>
        let currentSections = [];

        async function loadScript(day) {
            try {
                const response = await fetch(`./script/day${day}.txt`);
                const text = await response.text();
                parseContent(text);
            } catch (e) { document.getElementById('container').innerText = "íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."; }
        }

        function parseContent(rawText) {
            const lines = rawText.split('\n');
            document.getElementById('main-title').innerText = lines[0].replace('ğŸŒ³', '').trim(); // ì²« ì¤„ ì œëª©[cite: 1]

            const container = document.getElementById('container');
            container.innerHTML = "";
            currentSections = [];
            
            let tempSection = null;

            lines.slice(1).forEach(line => {
                const trimmed = line.trim();
                if (!trimmed) return;

                // Q1, Q2 ë“±ìœ¼ë¡œ ì‹œì‘í•˜ë©´ ìƒˆë¡œìš´ ì„¹ì…˜ ì‹œì‘
                if (line.match(/^Q\d+/)) {
                    if (tempSection) currentSections.push(tempSection);
                    tempSection = { title: trimmed, question: "", script: "" };
                } 
                else if (line.startsWith('Question:')) {
                    tempSection.question = line.replace('Question:', '').trim(); // ì§ˆë¬¸ ë‚´ìš© ì €ì¥[cite: 2, 11, 19]
                } 
                else if (line.startsWith('Script:')) {
                    tempSection.script = line.replace('Script:', '').trim() + "\n"; // ë‹µë³€ ì‹œì‘[cite: 3, 12, 19]
                } 
                else if (tempSection) {
                    // Script: ì´í›„ ë‹¤ìŒ Qê°€ ë‚˜ì˜¤ê¸° ì „ê¹Œì§€ ëª¨ë“  ì¤„ì„ í•©ì¹¨
                    tempSection.script += trimmed + "\n";
                }
            });
            if (tempSection) currentSections.push(tempSection);

            render(currentSections);
        }

        function render(data) {
            const container = document.getElementById('container');
            data.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="q-title">${item.title}</div>
                    <div class="q-question"><strong>Question:</strong> ${item.question}</div>
                    <button class="btn-play" onclick="playAudio(${index})">â–¶ ì´ ë¬¸ì œ ë‹µë³€ ë“£ê¸°</button>
                    <div class="s-box highlight-area blur">${item.script}</div>
                `;
                container.appendChild(card);
            });
        }

        function playAudio(index) {
            window.speechSynthesis.cancel(); // ì´ì „ ì¬ìƒ ì·¨ì†Œ
            const speech = new SpeechSynthesisUtterance(currentSections[index].script);
            speech.lang = 'en-US';
            speech.rate = 0.85; // ê³µë¶€í•˜ê¸° ì¢‹ê²Œ ì•½ê°„ ì²œì²œíˆ
            window.speechSynthesis.speak(speech);
        }

        function toggleBlur() {
            document.querySelectorAll('.highlight-area').forEach(el => el.classList.toggle('blur'));
        }

        window.onload = () => loadScript(1);
    </script>
</body>
</html>